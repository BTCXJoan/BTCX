<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>BTCX — Biblioteca Bitcoin</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<div class="subtitle">
BTCX Academy — Educación Bitcoin práctica<br>
Fundado por Joan Salvatella
</div>
<style>
body{
  background:#0b0f1a;
  color:white;
  font-family:-apple-system,BlinkMacSystemFont,Arial;
  text-align:center;
  padding:60px 20px;
}

.logo{
  width:120px;
  margin-bottom:20px;
}

.container{
  max-width:520px;
  margin:auto;
}

h1{
  font-weight:600;
}

.subtitle{
  color:#9ca3af;
  margin-bottom:30px;
}

.button{
  display:block;
  width:100%;
  max-width:320px;
  margin:10px auto;
  padding:14px;
  border-radius:10px;
  border:none;
  background:#2563eb;
  color:white;
  font-size:16px;
  cursor:pointer;
  text-decoration:none;
}

.secondary{
  background:#111827;
  color:#93c5fd;
  border:1px solid #2563eb;
}

.box{
  background:#111827;
  padding:18px;
  border-radius:12px;
  margin:25px 0;
}
</style>
</head>

<body>

<div class="container">

<img src="btcx-logo.png" class="logo">

<h1>BTCX</h1>

<div class="subtitle">
Academia Bitcoin con acceso mediante staking
</div>

<div class="box">
Para acceder al contenido necesitas mantener
<strong>2.000 BTCX</strong> en staking.
</div>

<button class="button" onclick="connect()">Conectar wallet</button>

<a class="button secondary" href="comprar.html">Comprar acceso (2000 BTCX)</a>

<div id="status"></div>

</div>

<script>

const stakingAddress="0xFc9016F9153D0a7e9A09DDca7Ad756F9485cEcbc";

const stakingABI=[
 "function hasAccess(address user) view returns(bool)"
];

async function connect(){

 if(!window.ethereum){
   document.getElementById("status").innerHTML="Instala MetaMask";
   return;
 }

 const provider=new ethers.providers.Web3Provider(window.ethereum);
 await provider.send("eth_requestAccounts",[]);
 const signer=provider.getSigner();
 const address=await signer.getAddress();

 const contract=new ethers.Contract(stakingAddress,stakingABI,provider);
 const access=await contract.hasAccess(address);

 if(access){
   document.getElementById("status").innerHTML=
   "Acceso activo ✔<br><br><a href='panel.html'>Entrar al panel</a>";
 }else{
   document.getElementById("status").innerHTML=
   "Wallet conectada pero sin staking activo.";
 }

}

</script>

</body>
</html>
